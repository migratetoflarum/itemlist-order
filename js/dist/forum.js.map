{"version":3,"sources":["webpack://@migratetoflarum/itemlist-order/webpack/bootstrap","webpack://@migratetoflarum/itemlist-order/./forum.js","webpack://@migratetoflarum/itemlist-order/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@migratetoflarum/itemlist-order/./src/forum/components/Editor.js","webpack://@migratetoflarum/itemlist-order/./src/forum/components/EditorModal.js","webpack://@migratetoflarum/itemlist-order/./src/forum/index.js","webpack://@migratetoflarum/itemlist-order/./src/forum/utils/applyCustomListItemOrdering.js","webpack://@migratetoflarum/itemlist-order/./src/forum/utils/getStoredConfigForItemList.js","webpack://@migratetoflarum/itemlist-order/./src/forum/utils/itemListToArrayWithoutExtractingContent.js","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['Component']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['app']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['components/Alert']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['components/Button']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['components/HeaderSecondary']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['components/LogInModal']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['components/SignUpModal']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['extend']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['helpers/icon']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['utils/ItemList']\"","webpack://@migratetoflarum/itemlist-order/external \"flarum.core.compat['utils/SubtreeRetainer']\""],"names":["Editor","init","config","getStoredConfigForItemList","props","name","itemsOrder","start","end","hidden","dirty","loading","saved","view","items","itemListToArrayWithoutExtractingContent","renderItem","item","itemName","indexInStart","indexOf","indexInEnd","indexInHidden","removeFromStart","splice","removeFromEnd","removeFromHidden","m","key","title","priority","content","onclick","push","disabled","icon","length","unshift","sectionsContent","nothingMessage","entries","map","find","i","defaultContent","filter","Alert","component","type","dismissible","ondismiss","children","Button","app","request","method","url","forum","attribute","data","then","result","attributes","itemorderConfig","redraw","className","Component","EditorModal","event","stopPropagation","target","classList","contains","close","onsubmit","preventDefault","isInitialized","$","modal","backdrop","finishedEdit","editModeEnabled","session","user","localStorage","getItem","extendList","object","edit","override","original","args","modified","ItemList","add","Object","keys","applyCustomListItemOrdering","extendListByName","objectName","methodName","flarum","core","compat","prototype","initializers","extend","HeaderSecondary","translator","trans","show","SignUpModal","LogInModal","SubtreeRetainer","startIndex","forEach","has","replace","endIndex","remove","hasOwnProperty","existingConfig","list","sort","a","b"],"mappings":";;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA,wC;;;;;;;;;;;;ACAA;AAAA;AAAe;AACf;AACA;AACA;AACA,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;IAEqBA,M;;;;;;;;;;;SACjBC,I,GAAA,gBAAO;AACH,yBAAMA,IAAN;;AAEA,QAAMC,MAAM,GAAGC,iFAA0B,CAAC,KAAKC,KAAL,CAAWC,IAAZ,CAAzC;AAEA,SAAKC,UAAL,GAAkBJ,MAAM,IAAI;AACxBK,WAAK,EAAE,EADiB;AAExBC,SAAG,EAAE,EAFmB;AAGxBC,YAAM,EAAE;AAHgB,KAA5B;AAMA,SAAKC,KAAL,GAAa,KAAb;AACA,SAAKC,OAAL,GAAe,KAAf;AACA,SAAKC,KAAL,GAAa,KAAb;AACH,G;;SAEDC,I,GAAA,gBAAO;AAAA;;AACH,QAAMC,KAAK,GAAGC,8FAAuC,CAAC,KAAKX,KAAL,CAAWU,KAAZ,CAArD;;AAEA,QAAME,UAAU,GAAG,SAAbA,UAAa,CAAAC,IAAI,EAAI;AAAA,UAChBC,QADgB,GACJD,IADI,CAChBC,QADgB;;AAEvB,UAAMC,YAAY,GAAG,KAAI,CAACb,UAAL,CAAgBC,KAAhB,CAAsBa,OAAtB,CAA8BF,QAA9B,CAArB;;AACA,UAAMG,UAAU,GAAG,KAAI,CAACf,UAAL,CAAgBE,GAAhB,CAAoBY,OAApB,CAA4BF,QAA5B,CAAnB;;AACA,UAAMI,aAAa,GAAG,KAAI,CAAChB,UAAL,CAAgBG,MAAhB,CAAuBW,OAAvB,CAA+BF,QAA/B,CAAtB;;AAEA,UAAMK,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAC1B,YAAIJ,YAAY,KAAK,CAAC,CAAtB,EAAyB;AACrB,eAAI,CAACb,UAAL,CAAgBC,KAAhB,CAAsBiB,MAAtB,CAA6BL,YAA7B,EAA2C,CAA3C;;AACA,eAAI,CAACT,KAAL,GAAa,IAAb;AACH;AACJ,OALD;;AAOA,UAAMe,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AACxB,YAAIJ,UAAU,KAAK,CAAC,CAApB,EAAuB;AACnB,eAAI,CAACf,UAAL,CAAgBE,GAAhB,CAAoBgB,MAApB,CAA2BH,UAA3B,EAAuC,CAAvC;;AACA,eAAI,CAACX,KAAL,GAAa,IAAb;AACH;AACJ,OALD;;AAOA,UAAMgB,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;AAC3B,YAAIJ,aAAa,KAAK,CAAC,CAAvB,EAA0B;AACtB,eAAI,CAAChB,UAAL,CAAgBG,MAAhB,CAAuBe,MAAvB,CAA8BF,aAA9B,EAA6C,CAA7C;;AACA,eAAI,CAACZ,KAAL,GAAa,IAAb;AACH;AACJ,OALD;;AAOA,aAAOiB,CAAC,CAAC,sBAAD,EAAyB;AAC7BC,WAAG,EAAE,UAAUX,IAAI,CAACC;AADS,OAAzB,EAEL,CACCS,CAAC,CAAC,0BAAD,EAA6B;AAC1BE,aAAK,EAAE,yBAAyBZ,IAAI,CAACC,QAA9B,GAAyC,wBAAzC,GAAoED,IAAI,CAACa;AADtD,OAA7B,EAEEb,IAAI,CAACc,OAFP,CADF,EAICJ,CAAC,CAAC,yBAAD,EAA4B,CACzBA,CAAC,CAAC,4BAAD,EAA+B;AAC5BE,aAAK,EAAE,SADqB;AAE5BG,eAAO,EAAE,mBAAM;AACXN,0BAAgB;;AAChB,cAAIP,YAAY,KAAK,CAAC,CAAtB,EAAyB;AACrB,gBAAIA,YAAY,GAAG,CAAnB,EAAsB;AAClBI,6BAAe;;AACf,mBAAI,CAACjB,UAAL,CAAgBC,KAAhB,CAAsBiB,MAAtB,CAA6BL,YAAY,GAAG,CAA5C,EAA+C,CAA/C,EAAkDD,QAAlD;;AACA,mBAAI,CAACR,KAAL,GAAa,IAAb;AACH,aALoB,CAMrB;;AACH,WAPD,MAOO,IAAIW,UAAU,KAAK,CAAC,CAApB,EAAuB;AAC1BI,yBAAa;;AACb,gBAAIJ,UAAU,KAAK,CAAnB,EAAsB;AAClB,mBAAI,CAACf,UAAL,CAAgBC,KAAhB,CAAsB0B,IAAtB,CAA2Bf,QAA3B;AACH,aAFD,MAEO;AACH,mBAAI,CAACZ,UAAL,CAAgBE,GAAhB,CAAoBgB,MAApB,CAA2BH,UAAU,GAAG,CAAxC,EAA2C,CAA3C,EAA8CH,QAA9C;AACH;;AACD,iBAAI,CAACR,KAAL,GAAa,IAAb;AACH,WARM,MAQA;AACH,iBAAI,CAACJ,UAAL,CAAgBC,KAAhB,CAAsB0B,IAAtB,CAA2Bf,QAA3B;;AACA,iBAAI,CAACR,KAAL,GAAa,IAAb;AACH;AACJ,SAvB2B;AAwB5BwB,gBAAQ,EAAE,KAAI,CAACvB;AAxBa,OAA/B,EAyBEwB,0DAAI,CAAC,iBAAD,CAzBN,CADwB,EA2BzBR,CAAC,CAAC,4BAAD,EAA+B;AAC5BE,aAAK,EAAE,WADqB;AAE5BG,eAAO,EAAE,mBAAM;AACXN,0BAAgB;;AAChB,cAAIL,UAAU,KAAK,CAAC,CAApB,EAAuB;AACnB,gBAAIA,UAAU,GAAG,KAAI,CAACf,UAAL,CAAgBE,GAAhB,CAAoB4B,MAApB,GAA6B,CAA9C,EAAiD;AAC7CX,2BAAa;;AACb,mBAAI,CAACnB,UAAL,CAAgBE,GAAhB,CAAoBgB,MAApB,CAA2BH,UAAU,GAAG,CAAxC,EAA2C,CAA3C,EAA8CH,QAA9C;;AACA,mBAAI,CAACR,KAAL,GAAa,IAAb;AACH,aALkB,CAMnB;;AACH,WAPD,MAOO,IAAIS,YAAY,KAAK,CAAC,CAAtB,EAAyB;AAC5B,gBAAIA,YAAY,KAAK,KAAI,CAACb,UAAL,CAAgBC,KAAhB,CAAsB6B,MAAtB,GAA+B,CAApD,EAAuD;AACnDb,6BAAe,GADoC,CAChC;;AACnB,mBAAI,CAACjB,UAAL,CAAgBE,GAAhB,CAAoB6B,OAApB,CAA4BnB,QAA5B;AACH,aAHD,MAGO;AACHK,6BAAe;;AACf,mBAAI,CAACjB,UAAL,CAAgBC,KAAhB,CAAsBiB,MAAtB,CAA6BL,YAAY,GAAG,CAA5C,EAA+C,CAA/C,EAAkDD,QAAlD;AACH;;AACD,iBAAI,CAACR,KAAL,GAAa,IAAb;AACH,WATM,MASA;AACH,iBAAI,CAACJ,UAAL,CAAgBE,GAAhB,CAAoB6B,OAApB,CAA4BnB,QAA5B;;AACA,iBAAI,CAACR,KAAL,GAAa,IAAb;AACH;AACJ,SAxB2B;AAyB5BwB,gBAAQ,EAAE,KAAI,CAACvB;AAzBa,OAA/B,EA0BEwB,0DAAI,CAAC,mBAAD,CA1BN,CA3BwB,EAsDzBR,CAAC,CAAC,4BAAD,EAA+B;AAC5BE,aAAK,EAAE,MADqB;AAE5BG,eAAO,EAAE,mBAAM;AACX,cAAIV,aAAa,KAAK,CAAC,CAAvB,EAA0B;AACtBC,2BAAe;AACfE,yBAAa;;AACb,iBAAI,CAACnB,UAAL,CAAgBG,MAAhB,CAAuBwB,IAAvB,CAA4Bf,QAA5B;;AACA,iBAAI,CAACR,KAAL,GAAa,IAAb;AACH,WALD,MAKO;AACHgB,4BAAgB;AACnB;AACJ,SAX2B;AAY5BQ,gBAAQ,EAAE,KAAI,CAACvB;AAZa,OAA/B,EAaEwB,0DAAI,CAAC,gBAAgBb,aAAa,KAAK,CAAC,CAAnB,GAAuB,QAAvB,GAAkC,EAAlD,CAAD,CAbN,CAtDwB,EAoEzBK,CAAC,CAAC,4BAAD,EAA+B;AAC5BE,aAAK,EAAE,0BADqB;AAE5BG,eAAO,EAAE,mBAAM;AACXT,yBAAe;AACfE,uBAAa;AACbC,0BAAgB;AACnB,SAN2B;AAO5BQ,gBAAQ,EAAE,KAAI,CAACvB;AAPa,OAA/B,EAQEwB,0DAAI,CAAC,aAAD,CARN,CApEwB,CAA5B,CAJF,CAFK,CAAR;AAqFH,KAhHD;;AAkHA,QAAMG,eAAe,GAAG,SAAlBA,eAAkB,CAACV,GAAD,EAAMW,cAAN,EAAyB;AAC7C,UAAMC,OAAO,GAAG,KAAI,CAAClC,UAAL,CAAgBsB,GAAhB,EAAqBa,GAArB,CAAyB,UAAAvB,QAAQ,EAAI;AACjD,YAAMD,IAAI,GAAGH,KAAK,CAAC4B,IAAN,CAAW,UAAAC,CAAC;AAAA,iBAAIA,CAAC,CAACzB,QAAF,KAAeA,QAAnB;AAAA,SAAZ,CAAb,CADiD,CAGjD;;AACA,eAAOF,UAAU,CAACC,IAAD,CAAjB;AACH,OALe,CAAhB;;AAOA,UAAIuB,OAAO,CAACJ,MAAZ,EAAoB;AAChB,eAAOI,OAAP;AACH;;AAED,aAAOb,CAAC,CAAC,GAAD,EAAM;AACVC,WAAG,EAAE,WAAWA;AADN,OAAN,EAELW,cAFK,CAAR;AAGH,KAfD;;AAiBA,QAAMK,cAAc,GAAG9B,KAAK,CAAC+B,MAAN,CAAa,UAAA5B,IAAI,EAAI;AAAA,UACjCC,QADiC,GACrBD,IADqB,CACjCC,QADiC;;AAExC,UAAMC,YAAY,GAAG,KAAI,CAACb,UAAL,CAAgBC,KAAhB,CAAsBa,OAAtB,CAA8BF,QAA9B,CAArB;;AACA,UAAMG,UAAU,GAAG,KAAI,CAACf,UAAL,CAAgBE,GAAhB,CAAoBY,OAApB,CAA4BF,QAA5B,CAAnB;;AACA,UAAMI,aAAa,GAAG,KAAI,CAAChB,UAAL,CAAgBG,MAAhB,CAAuBW,OAAvB,CAA+BF,QAA/B,CAAtB;;AAEA,aAAOC,YAAY,KAAK,CAAC,CAAlB,IAAuBE,UAAU,KAAK,CAAC,CAAvC,IAA4CC,aAAa,KAAK,CAAC,CAAtE;AACH,KAPsB,EAOpBmB,GAPoB,CAOhB,UAAAxB,IAAI;AAAA,aAAID,UAAU,CAACC,IAAD,CAAd;AAAA,KAPY,CAAvB;;AASA,QAAI,CAAC2B,cAAc,CAACR,MAApB,EAA4B;AACxBQ,oBAAc,CAACX,IAAf,CAAoBN,CAAC,CAAC,GAAD,EAAM;AACvBC,WAAG,EAAE;AADkB,OAAN,EAElB,qFAFkB,CAArB;AAGH;;AAED,WAAOD,CAAC,CAAC,wBAAD,EAA2B,CAC/B,KAAKf,KAAL,GAAakC,8DAAK,CAACC,SAAN,CAAgB;AACzBC,UAAI,EAAE,MADmB;AAEzBC,iBAAW,EAAE,IAFY;AAGzBC,eAAS,EAAE,qBAAM;AACb,aAAI,CAACtC,KAAL,GAAa,KAAb;AACH,OALwB;AAMzBuC,cAAQ,EAAE;AANe,KAAhB,CAAb,GAOK,IAR0B,EAS/BC,+DAAM,CAACL,SAAP,CAAiB;AACbf,aAAO,EAAE,mBAAM;AACX,aAAI,CAACrB,OAAL,GAAe,IAAf;AAEA0C,yDAAG,CAACC,OAAJ,CAAY;AACRC,gBAAM,EAAE,MADA;AAERC,aAAG,EAAEH,iDAAG,CAACI,KAAJ,CAAUC,SAAV,CAAoB,QAApB,IAAgC,kBAAhC,GAAqD,KAAI,CAACtD,KAAL,CAAWC,IAF7D;AAGRsD,cAAI,EAAE,KAAI,CAACrD;AAHH,SAAZ,EAIGsD,IAJH,CAIQ,UAAAC,MAAM,EAAI;AACd,eAAI,CAAClD,OAAL,GAAe,KAAf;AACA,eAAI,CAACC,KAAL,GAAa,IAAb;AACA,eAAI,CAACF,KAAL,GAAa,KAAb;AACA2C,2DAAG,CAACI,KAAJ,CAAUE,IAAV,CAAeG,UAAf,CAA0BC,eAA1B,GAA4CF,MAA5C;AACAlC,WAAC,CAACqC,MAAF;AACH,SAVD;AAWH,OAfY;AAgBbC,eAAS,EAAE,wBAhBE;AAiBbd,cAAQ,EAAE,MAjBG;AAkBbjB,cAAQ,EAAE,CAAC,KAAKxB,KAlBH;AAmBbC,aAAO,EAAE,KAAKA;AAnBD,KAAjB,CAT+B,EA8B/B,GA9B+B,EA+B/ByC,+DAAM,CAACL,SAAP,CAAiB;AACbf,aAAO,EAAE,mBAAM;AACX,aAAI,CAAC1B,UAAL,GAAkB;AACdC,eAAK,EAAE,EADO;AAEdC,aAAG,EAAE,EAFS;AAGdC,gBAAM,EAAE;AAHM,SAAlB;AAKA,aAAI,CAACC,KAAL,GAAa,IAAb;AACH,OARY;AASbyB,UAAI,EAAE,aATO;AAUb8B,eAAS,EAAE,QAVE;AAWbd,cAAQ,EAAE,uBAXG;AAYbjB,cAAQ,EAAE,KAAKvB;AAZF,KAAjB,CA/B+B,EA6C/BgB,CAAC,CAAC,KAAD,EAAQ,CACLA,CAAC,CAAC,IAAD,EAAO;AACJC,SAAG,EAAE;AADD,KAAP,EAEE,QAFF,CADI,EAILU,eAAe,CAAC,OAAD,EAAU,qCAAV,CAJV,EAKLX,CAAC,CAAC,IAAD,EAAO;AACJC,SAAG,EAAE;AADD,KAAP,EAEE,SAFF,CALI,EAQLgB,cARK,EASLjB,CAAC,CAAC,IAAD,EAAO;AACJC,SAAG,EAAE;AADD,KAAP,EAEE,OAFF,CATI,EAYLU,eAAe,CAAC,KAAD,EAAQ,uCAAR,CAZV,EAaLX,CAAC,CAAC,IAAD,EAAO;AACJC,SAAG,EAAE;AADD,KAAP,EAEE,QAFF,CAbI,EAgBLU,eAAe,CAAC,QAAD,EAAW,iCAAX,CAhBV,CAAR,CA7C8B,CAA3B,CAAR;AAgEH,G;;;EAtO+B4B,uD;;;;;;;;;;;;;;;;;;;;;;;ACVpC;AACA;AACA;AAEA;AAEA;AACA;;IACqBC,W;;;;;;;;;;;SACjBtD,I,GAAA,gBAAO;AAAA;;AACH,WAAOc,CAAC,CAAC,uBAAD,EAA0B,CAC9BA,CAAC,CAAC,8BAAD,EAAiC;AAC9BK,aAAO,EAAE,iBAAAoC,KAAK,EAAI;AACd;AACA;AACAA,aAAK,CAACC,eAAN,GAHc,CAKd;;AACA,YAAID,KAAK,CAACE,MAAN,CAAaC,SAAb,CAAuBC,QAAvB,CAAgC,cAAhC,CAAJ,EAAqD;AACjD,eAAI,CAACC,KAAL;AACH;AACJ,OAV6B;AAW9BC,cAAQ,EAAE,kBAAAN,KAAK,EAAI;AACf;AACAA,aAAK,CAACO,cAAN;AACH;AAd6B,KAAjC,EAeEhD,CAAC,CAAC,qBAAD,EAAwBA,CAAC,CAAC,gBAAD,EAAmB,CAC5CA,CAAC,CAAC,cAAD,EAAiByB,+DAAM,CAACL,SAAP,CAAiB;AAC/BZ,UAAI,EAAE,cADyB;AAE/BH,aAAO,EAAE,mBAAM;AACX,aAAI,CAACyC,KAAL;AACH,OAJ8B;AAK/BR,eAAS,EAAE;AALoB,KAAjB,CAAjB,CAD2C,EAQ5CtC,CAAC,CAAC,eAAD,EAAkBA,CAAC,CAAC,4CAAD,EAA+C,qBAAqB,KAAKvB,KAAL,CAAWC,IAA/E,CAAnB,CAR2C,EAS5CsB,CAAC,CAAC,aAAD,EAAgB3B,+CAAM,CAAC+C,SAAP,CAAiB;AAC9BjC,WAAK,EAAE,KAAKV,KAAL,CAAWU,KADY;AAE9BT,UAAI,EAAE,KAAKD,KAAL,CAAWC;AAFa,KAAjB,CAAhB,CAT2C,CAAnB,CAAzB,CAfH,CAD6B,EA8B9BsB,CAAC,CAAC,yBAAD,CA9B6B,CAA1B,CAAR;AAgCH,G;;SAEDzB,M,GAAA,gBAAO0E,aAAP,EAAsB;AAClB,QAAIA,aAAJ,EAAmB;AACf;AACH,KAHiB,CAKlB;AACA;AACA;;;AACA,SAAKC,CAAL,CAAO,QAAP,EAAiBC,KAAjB,CAAuB;AAACC,cAAQ,EAAE;AAAX,KAAvB,EAA0CD,KAA1C,CAAgD,MAAhD;AACH,G;;SAEDL,K,GAAA,iBAAQ;AACJ;AACA,SAAKI,CAAL,CAAO,QAAP,EAAiBC,KAAjB,CAAuB,MAAvB;AAEA,SAAK1E,KAAL,CAAW4E,YAAX;AACH,G;;;EApDoCd,uD;;;;;;;;;;;;;;ACRzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA,SAASe,eAAT,GAA2B;AACvB,SAAO5B,iDAAG,CAAC6B,OAAJ,CAAYC,IAAZ,IAAoBC,YAAY,CAACC,OAAb,CAAqB,qCAArB,MAAgE,MAA3F;AACH;;AAED,SAASC,UAAT,CAAoBC,MAApB,EAA4BhC,MAA5B,EAAoClD,IAApC,EAA0C;AACtC,MAAImF,IAAI,GAAG,KAAX;AAEAC,gEAAQ,CAACF,MAAD,EAAShC,MAAT,EAAiB,UAAUmC,QAAV,EAA6B;AAAA,sCAANC,IAAM;AAANA,UAAM;AAAA;;AAClD,QAAM7E,KAAK,GAAG4E,QAAQ,MAAR,SAAYC,IAAZ,CAAd;;AAEA,QAAIH,IAAJ,EAAU;AACN,UAAMI,QAAQ,GAAG,IAAIC,4DAAJ,EAAjB;AAEAD,cAAQ,CAACE,GAAT,CAAa,uBAAb,EAAsC3B,+DAAW,CAACpB,SAAZ,CAAsB;AACxDjC,aAAK,EAALA,KADwD;AAExDT,YAAI,EAAJA,IAFwD;AAGxD2E,oBAHwD,0BAGzC;AACXQ,cAAI,GAAG,KAAP;AACH;AALuD,OAAtB,CAAtC;AAQA,aAAOI,QAAP;AACH,KAfiD,CAiBlD;AACA;;;AACA,QAAI,CAACG,MAAM,CAACC,IAAP,CAAYlF,KAAK,CAACA,KAAlB,EAAyBsB,MAA9B,EAAsC;AAClC,aAAOtB,KAAP;AACH;;AAED,QAAMZ,MAAM,GAAGC,kFAA0B,CAACE,IAAD,CAAzC;;AAEA,QAAIH,MAAJ,EAAY;AACR+F,wFAA2B,CAACnF,KAAD,EAAQZ,MAAR,CAA3B;AACH;;AAED,QAAI+E,eAAe,EAAnB,EAAuB;AACnBnE,WAAK,CAACgF,GAAN,CAAU,wBAAV,EAAoC1C,+DAAM,CAACL,SAAP,CAAiB;AACjDf,eAAO,EAAE,iBAAAoC,KAAK,EAAI;AACdA,eAAK,CAACC,eAAN,GADc,CACW;;AACzBmB,cAAI,GAAG,IAAP;AACH,SAJgD;AAKjDrD,YAAI,EAAE,eAL2C;AAMjD8B,iBAAS,EAAE,QANsC;AAOjDd,gBAAQ,EAAE,YAPuC;AAQjDtB,aAAK,EAAExB;AAR0C,OAAjB,CAApC,EASI,CAAC,KATL;AAUH;;AAED,WAAOS,KAAP;AACH,GA3CO,CAAR;AA4CH;;AAED,SAASoF,gBAAT,CAA0BC,UAA1B,EAAsCC,UAAtC,EAAkD;AAC9C,MAAIb,MAAM,GAAGc,MAAM,CAACC,IAAP,CAAYC,MAAZ,CAAmBJ,UAAnB,CAAb;;AAEA,MAAIA,UAAU,CAAC/E,OAAX,CAAmB,aAAnB,MAAsC,CAA1C,EAA6C;AACzCmE,UAAM,GAAGA,MAAM,CAACiB,SAAhB;AACH;;AAEDlB,YAAU,CAACC,MAAD,EAASa,UAAT,EAAqBD,UAAU,GAAG,GAAb,GAAmBC,UAAxC,CAAV;AACH;;AAED/C,iDAAG,CAACoD,YAAJ,CAAiBX,GAAjB,CAAqB,gCAArB,EAAuD,YAAM;AACzDY,8DAAM,CAACC,wEAAe,CAACH,SAAjB,EAA4B,OAA5B,EAAqC,UAAA1F,KAAK,EAAI;AAChD,QAAI,CAACmE,eAAe,EAApB,EAAwB;AACpB;AACH;;AAED,QAAI5B,iDAAG,CAACI,KAAJ,CAAUC,SAAV,CAAoB,aAApB,CAAJ,EAAwC;AACpC5C,WAAK,CAACgF,GAAN,CAAU,QAAV,EACI1C,+DAAM,CAACL,SAAP,CAAiB;AACbI,gBAAQ,EAAEE,iDAAG,CAACuD,UAAJ,CAAeC,KAAf,CAAqB,gCAArB,CADG;AAEb5C,iBAAS,EAAE,qBAFE;AAGbjC,eAAO,EAAE;AAAA,iBAAMqB,iDAAG,CAACyB,KAAJ,CAAUgC,IAAV,CAAe,IAAIC,oEAAJ,EAAf,CAAN;AAAA;AAHI,OAAjB,CADJ,EAKQ,EALR;AAOH;;AAEDjG,SAAK,CAACgF,GAAN,CAAU,OAAV,EACI1C,+DAAM,CAACL,SAAP,CAAiB;AACbI,cAAQ,EAAEE,iDAAG,CAACuD,UAAJ,CAAeC,KAAf,CAAqB,+BAArB,CADG;AAEb5C,eAAS,EAAE,qBAFE;AAGbjC,aAAO,EAAE;AAAA,eAAMqB,iDAAG,CAACyB,KAAJ,CAAUgC,IAAV,CAAe,IAAIE,mEAAJ,EAAf,CAAN;AAAA;AAHI,KAAjB,CADJ,EAKQ,CALR;AAOH,GAtBK,CAAN,CADyD,CAyBzD;AACA;;AACAvB,gEAAQ,CAACwB,mEAAe,CAACT,SAAjB,EAA4B,QAA5B,EAAsC,UAAAd,QAAQ,EAAI;AACtD,QAAIT,eAAe,EAAnB,EAAuB;AACnB,aAAO,KAAP;AACH;;AAED,WAAOS,QAAQ,EAAf;AACH,GANO,CAAR;AAQAQ,kBAAgB,CAAC,wBAAD,EAA2B,aAA3B,CAAhB;AACAA,kBAAgB,CAAC,+BAAD,EAAkC,aAAlC,CAAhB;AACAA,kBAAgB,CAAC,2BAAD,EAA8B,OAA9B,CAAhB,CArCyD,CAsCzD;;AACAA,kBAAgB,CAAC,2BAAD,EAA8B,cAA9B,CAAhB;AACAA,kBAAgB,CAAC,0BAAD,EAA6B,OAA7B,CAAhB;AACAA,kBAAgB,CAAC,4BAAD,EAA+B,OAA/B,CAAhB;AACAA,kBAAgB,CAAC,sBAAD,EAAyB,cAAzB,CAAhB;AACAA,kBAAgB,CAAC,sBAAD,EAAyB,WAAzB,CAAhB;AACAA,kBAAgB,CAAC,sBAAD,EAAyB,aAAzB,CAAhB;AACAA,kBAAgB,CAAC,uBAAD,EAA0B,QAA1B,CAAhB;AACAA,kBAAgB,CAAC,yBAAD,EAA4B,OAA5B,CAAhB;AACAA,kBAAgB,CAAC,0BAAD,EAA6B,aAA7B,CAAhB;AACAA,kBAAgB,CAAC,4BAAD,EAA+B,OAA/B,CAAhB;AACAA,kBAAgB,CAAC,yBAAD,EAA4B,eAA5B,CAAhB;AACAA,kBAAgB,CAAC,wBAAD,EAA2B,QAA3B,CAAhB;AACAA,kBAAgB,CAAC,uBAAD,EAA0B,cAA1B,CAAhB;AACAA,kBAAgB,CAAC,uBAAD,EAA0B,cAA1B,CAAhB;AACAA,kBAAgB,CAAC,qBAAD,EAAwB,WAAxB,CAAhB;AACAA,kBAAgB,CAAC,qBAAD,EAAwB,UAAxB,CAAhB;AACAA,kBAAgB,CAAC,0BAAD,EAA6B,UAA7B,CAAhB;AACAA,kBAAgB,CAAC,oBAAD,EAAuB,UAAvB,CAAhB;AACAA,kBAAgB,CAAC,oBAAD,EAAuB,UAAvB,CAAhB,CAzDyD,CA0DzD;AACH,CA3DD,EA2DG,CAAC,IA3DJ,E,CA2DW,6E;;;;;;;;;;;;ACxIX;AAAe,yEAAUpF,KAAV,EAAiBZ,MAAjB,EAAyB;AACpC,MAAIgH,UAAU,GAAG,KAAjB,CADoC,CACZ;;AACxBhH,QAAM,CAACK,KAAP,CAAa4G,OAAb,CAAqB,UAAA9G,IAAI,EAAI;AACzB,QAAIS,KAAK,CAACsG,GAAN,CAAU/G,IAAV,CAAJ,EAAqB;AACjBS,WAAK,CAACuG,OAAN,CAAchH,IAAd,EAAoB,IAApB,EAA0B6G,UAAU,EAApC;AACH;AACJ,GAJD;AAMA,MAAII,QAAQ,GAAG,CAAC,KAAhB,CARoC,CAQb;;AACvBpH,QAAM,CAACM,GAAP,CAAW2G,OAAX,CAAmB,UAAA9G,IAAI,EAAI;AACvB,QAAIS,KAAK,CAACsG,GAAN,CAAU/G,IAAV,CAAJ,EAAqB;AACjBS,WAAK,CAACuG,OAAN,CAAchH,IAAd,EAAoB,IAApB,EAA0BiH,QAAQ,EAAlC;AACH;AACJ,GAJD;AAMApH,QAAM,CAACO,MAAP,CAAc0G,OAAd,CAAsB,UAAA9G,IAAI,EAAI;AAC1B,QAAIS,KAAK,CAACsG,GAAN,CAAU/G,IAAV,CAAJ,EAAqB;AACjBS,WAAK,CAACyG,MAAN,CAAalH,IAAb;AACH;AACJ,GAJD;AAKH,C;;;;;;;;;;;;ACpBD;AAAA;AAAA;AAAA;AAEe,yEAAUA,IAAV,EAAgB;AAC3B,MAAIgD,iDAAG,CAACI,KAAJ,CAAUE,IAAV,CAAeG,UAAf,CAA0BC,eAA1B,IAA6CV,iDAAG,CAACI,KAAJ,CAAUE,IAAV,CAAeG,UAAf,CAA0BC,eAA1B,CAA0CyD,cAA1C,CAAyDnH,IAAzD,CAAjD,EAAiH;AAC7G,QAAMoH,cAAc,GAAGpE,iDAAG,CAACI,KAAJ,CAAUE,IAAV,CAAeG,UAAf,CAA0BC,eAA1B,CAA0C1D,IAA1C,CAAvB;AAEA,WAAO;AACHE,WAAK,EAAEkH,cAAc,CAAClH,KAAf,IAAwB,EAD5B;AAEHC,SAAG,EAAEiH,cAAc,CAACjH,GAAf,IAAsB,EAFxB;AAGHC,YAAM,EAAEgH,cAAc,CAAChH,MAAf,IAAyB;AAH9B,KAAP;AAKH;;AAED,SAAO,IAAP;AACH,C;;;;;;;;;;;;ACdD;AAAA;AACe,yEAAUiH,IAAV,EAAgB;AAC3B,MAAM5G,KAAK,GAAG,EAAd;;AAEA,OAAK,IAAM6B,CAAX,IAAgB+E,IAAI,CAAC5G,KAArB,EAA4B;AACxB,QAAI4G,IAAI,CAAC5G,KAAL,CAAW0G,cAAX,CAA0B7E,CAA1B;AAA6B;AAAjC,MAAiG;AAC7F+E,YAAI,CAAC5G,KAAL,CAAW6B,CAAX,EAAcZ,OAAd,GAAwBgE,MAAM,CAAC2B,IAAI,CAAC5G,KAAL,CAAW6B,CAAX,EAAcZ,OAAf,CAA9B;AAEA2F,YAAI,CAAC5G,KAAL,CAAW6B,CAAX,EAAcZ,OAAd,CAAsBb,QAAtB,GAAiCyB,CAAjC;AACA7B,aAAK,CAACmB,IAAN,CAAWyF,IAAI,CAAC5G,KAAL,CAAW6B,CAAX,CAAX;AACA+E,YAAI,CAAC5G,KAAL,CAAW6B,CAAX,EAAcf,GAAd,GAAoBd,KAAK,CAACsB,MAA1B;AACAsF,YAAI,CAAC5G,KAAL,CAAW6B,CAAX,EAAczB,QAAd,GAAyByB,CAAzB,CAN6F,CAMjE;AAC/B;AACJ;;AAED,SAAO7B,KAAK,CAAC6G,IAAN,CAAW,UAACC,CAAD,EAAIC,CAAJ,EAAU;AACxB,QAAID,CAAC,CAAC9F,QAAF,KAAe+F,CAAC,CAAC/F,QAArB,EAA+B;AAC3B,aAAO8F,CAAC,CAAChG,GAAF,GAAQiG,CAAC,CAACjG,GAAjB;AACH,KAFD,MAEO,IAAIgG,CAAC,CAAC9F,QAAF,GAAa+F,CAAC,CAAC/F,QAAnB,EAA6B;AAChC,aAAO,CAAC,CAAR;AACH;;AACD,WAAO,CAAP;AACH,GAPM,CAAP;AAQH,C;;;;;;;;;;;ACvBD,iD;;;;;;;;;;;ACAA,2C;;;;;;;;;;;ACAA,wD;;;;;;;;;;;ACAA,yD;;;;;;;;;;;ACAA,kE;;;;;;;;;;;ACAA,6D;;;;;;;;;;;ACAA,8D;;;;;;;;;;;ACAA,8C;;;;;;;;;;;ACAA,oD;;;;;;;;;;;ACAA,sD;;;;;;;;;;;ACAA,6D","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';\n","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","import app from 'flarum/app';\nimport icon from 'flarum/helpers/icon';\nimport Component from 'flarum/Component';\nimport Button from 'flarum/components/Button';\nimport Alert from 'flarum/components/Alert';\nimport itemListToArrayWithoutExtractingContent from '../utils/itemListToArrayWithoutExtractingContent';\nimport getStoredConfigForItemList from '../utils/getStoredConfigForItemList';\n\n/* global m */\n\nexport default class Editor extends Component {\n    init() {\n        super.init();\n\n        const config = getStoredConfigForItemList(this.props.name);\n\n        this.itemsOrder = config || {\n            start: [],\n            end: [],\n            hidden: [],\n        };\n\n        this.dirty = false;\n        this.loading = false;\n        this.saved = false;\n    }\n\n    view() {\n        const items = itemListToArrayWithoutExtractingContent(this.props.items);\n\n        const renderItem = item => {\n            const {itemName} = item;\n            const indexInStart = this.itemsOrder.start.indexOf(itemName);\n            const indexInEnd = this.itemsOrder.end.indexOf(itemName);\n            const indexInHidden = this.itemsOrder.hidden.indexOf(itemName);\n\n            const removeFromStart = () => {\n                if (indexInStart !== -1) {\n                    this.itemsOrder.start.splice(indexInStart, 1);\n                    this.dirty = true;\n                }\n            };\n\n            const removeFromEnd = () => {\n                if (indexInEnd !== -1) {\n                    this.itemsOrder.end.splice(indexInEnd, 1);\n                    this.dirty = true;\n                }\n            };\n\n            const removeFromHidden = () => {\n                if (indexInHidden !== -1) {\n                    this.itemsOrder.hidden.splice(indexInHidden, 1);\n                    this.dirty = true;\n                }\n            };\n\n            return m('.Itemlist-Order-Item', {\n                key: 'item-' + item.itemName,\n            }, [\n                m('.Itemlist-Order-Original', {\n                    title: 'Internal item name: ' + item.itemName + ' - Original priority: ' + item.priority,\n                }, item.content),\n                m('.Itemlist-Order-Actions', [\n                    m('button.Button.Button--link', {\n                        title: 'Move up',\n                        onclick: () => {\n                            removeFromHidden();\n                            if (indexInStart !== -1) {\n                                if (indexInStart > 0) {\n                                    removeFromStart();\n                                    this.itemsOrder.start.splice(indexInStart - 1, 0, itemName);\n                                    this.dirty = true;\n                                }\n                                // else: already at the top, don't move the item\n                            } else if (indexInEnd !== -1) {\n                                removeFromEnd();\n                                if (indexInEnd === 0) {\n                                    this.itemsOrder.start.push(itemName);\n                                } else {\n                                    this.itemsOrder.end.splice(indexInEnd - 1, 0, itemName);\n                                }\n                                this.dirty = true;\n                            } else {\n                                this.itemsOrder.start.push(itemName);\n                                this.dirty = true;\n                            }\n                        },\n                        disabled: this.loading,\n                    }, icon('fas fa-angle-up')),\n                    m('button.Button.Button--link', {\n                        title: 'Move down',\n                        onclick: () => {\n                            removeFromHidden();\n                            if (indexInEnd !== -1) {\n                                if (indexInEnd < this.itemsOrder.end.length - 1) {\n                                    removeFromEnd();\n                                    this.itemsOrder.end.splice(indexInEnd + 1, 0, itemName);\n                                    this.dirty = true;\n                                }\n                                // else: already at the bottom, don't move the item\n                            } else if (indexInStart !== -1) {\n                                if (indexInStart === this.itemsOrder.start.length - 1) {\n                                    removeFromStart(); // Can't put this above condition or it would change the array length\n                                    this.itemsOrder.end.unshift(itemName);\n                                } else {\n                                    removeFromStart();\n                                    this.itemsOrder.start.splice(indexInStart + 1, 0, itemName);\n                                }\n                                this.dirty = true;\n                            } else {\n                                this.itemsOrder.end.unshift(itemName);\n                                this.dirty = true;\n                            }\n                        },\n                        disabled: this.loading,\n                    }, icon('fas fa-angle-down')),\n                    m('button.Button.Button--link', {\n                        title: 'Hide',\n                        onclick: () => {\n                            if (indexInHidden === -1) {\n                                removeFromStart();\n                                removeFromEnd();\n                                this.itemsOrder.hidden.push(itemName);\n                                this.dirty = true;\n                            } else {\n                                removeFromHidden();\n                            }\n                        },\n                        disabled: this.loading,\n                    }, icon('fas fa-eye' + (indexInHidden === -1 ? '-slash' : ''))),\n                    m('button.Button.Button--link', {\n                        title: 'Restore default position',\n                        onclick: () => {\n                            removeFromStart();\n                            removeFromEnd();\n                            removeFromHidden();\n                        },\n                        disabled: this.loading,\n                    }, icon('fas fa-undo')),\n                ]),\n            ]);\n        };\n\n        const sectionsContent = (key, nothingMessage) => {\n            const entries = this.itemsOrder[key].map(itemName => {\n                const item = items.find(i => i.itemName === itemName);\n\n                // TODO: handle missing items\n                return renderItem(item);\n            });\n\n            if (entries.length) {\n                return entries;\n            }\n\n            return m('p', {\n                key: 'empty-' + key,\n            }, nothingMessage);\n        };\n\n        const defaultContent = items.filter(item => {\n            const {itemName} = item;\n            const indexInStart = this.itemsOrder.start.indexOf(itemName);\n            const indexInEnd = this.itemsOrder.end.indexOf(itemName);\n            const indexInHidden = this.itemsOrder.hidden.indexOf(itemName);\n\n            return indexInStart === -1 && indexInEnd === -1 && indexInHidden === -1;\n        }).map(item => renderItem(item));\n\n        if (!defaultContent.length) {\n            defaultContent.push(m('p', {\n                key: 'empty-default',\n            }, 'Items that appear in other situations or added by new extensions will be added here'));\n        }\n\n        return m('.ItemList-Order-Editor', [\n            this.saved ? Alert.component({\n                type: 'info',\n                dismissible: true,\n                ondismiss: () => {\n                    this.saved = false;\n                },\n                children: 'Saved !',\n            }) : null,\n            Button.component({\n                onclick: () => {\n                    this.loading = true;\n\n                    app.request({\n                        method: 'POST',\n                        url: app.forum.attribute('apiUrl') + '/itemlist-order/' + this.props.name,\n                        data: this.itemsOrder,\n                    }).then(result => {\n                        this.loading = false;\n                        this.saved = true;\n                        this.dirty = false;\n                        app.forum.data.attributes.itemorderConfig = result;\n                        m.redraw();\n                    });\n                },\n                className: 'Button Button--primary',\n                children: 'Save',\n                disabled: !this.dirty,\n                loading: this.loading,\n            }),\n            ' ',\n            Button.component({\n                onclick: () => {\n                    this.itemsOrder = {\n                        start: [],\n                        end: [],\n                        hidden: [],\n                    };\n                    this.dirty = true;\n                },\n                icon: 'fas fa-undo',\n                className: 'Button',\n                children: 'Restore default order',\n                disabled: this.loading,\n            }),\n            m('div', [\n                m('h4', {\n                    key: 'head-start',\n                }, 'Before'),\n                sectionsContent('start', 'Move elements up to place them here'),\n                m('h4', {\n                    key: 'head-default',\n                }, 'Default'),\n                defaultContent,\n                m('h4', {\n                    key: 'head-end',\n                }, 'After'),\n                sectionsContent('end', 'Move elements down to place them here'),\n                m('h4', {\n                    key: 'head-hidden',\n                }, 'Hidden'),\n                sectionsContent('hidden', 'You have not hidden any element'),\n            ]),\n        ]);\n    }\n}\n","import Component from 'flarum/Component';\nimport Button from 'flarum/components/Button';\nimport Editor from './Editor';\n\n/* global m */\n\n// We can't use Flarum modals because in order to render the itemlist children,\n// the modal has to be a child of the itemlist itself or we would break Mithril rendering tree\nexport default class EditorModal extends Component {\n    view() {\n        return m('.Itemlist-Order-Modal', [\n            m('form.ModalManager.modal.fade', {\n                onclick: event => {\n                    // When we create the modal as a child of a dropdown, we need to stop propagation\n                    // Otherwise any click would close the dropdown and hide the modal\n                    event.stopPropagation();\n\n                    // Close modal when backdrop is clicked\n                    if (event.target.classList.contains('ModalManager')) {\n                        this.close();\n                    }\n                },\n                onsubmit: event => {\n                    // Having a form inside of our modal prevents submitting other modals when we are a child of them\n                    event.preventDefault();\n                },\n            }, m('.Modal.modal-dialog', m('.Modal-content', [\n                m('.Modal-close', Button.component({\n                    icon: 'fas fa-times',\n                    onclick: () => {\n                        this.close();\n                    },\n                    className: 'Button Button--icon Button--link',\n                })),\n                m('.Modal-header', m('h3.App-titleControl App-titleControl--text', 'Update order of ' + this.props.name)),\n                m('.Modal-body', Editor.component({\n                    items: this.props.items,\n                    name: this.props.name,\n                })),\n            ]))),\n            m('.modal-backdrop.fade.in'),\n        ]);\n    }\n\n    config(isInitialized) {\n        if (isInitialized) {\n            return;\n        }\n\n        // Call bootstrap's modal method to correctly configure scrolling of the modal\n        // But in fact the modal is already partially hard-coded visible\n        // And we use our own backdrop to insert it inside our custom manager\n        this.$('.modal').modal({backdrop: false}).modal('show');\n    }\n\n    close() {\n        // Properly close modal, removes body class\n        this.$('.modal').modal('hide');\n\n        this.props.finishedEdit();\n    }\n}\n","import {extend, override} from 'flarum/extend';\nimport app from 'flarum/app';\nimport ItemList from 'flarum/utils/ItemList';\nimport Button from 'flarum/components/Button';\nimport HeaderSecondary from 'flarum/components/HeaderSecondary';\nimport SignUpModal from 'flarum/components/SignUpModal';\nimport LogInModal from 'flarum/components/LogInModal';\nimport SubtreeRetainer from 'flarum/utils/SubtreeRetainer';\nimport applyCustomListItemOrdering from './utils/applyCustomListItemOrdering';\nimport EditorModal from './components/EditorModal';\nimport getStoredConfigForItemList from './utils/getStoredConfigForItemList';\n\n/* global flarum */\n\nfunction editModeEnabled() {\n    return app.session.user && localStorage.getItem('migratetoflarum-itemlist-order-mode') === 'edit';\n}\n\nfunction extendList(object, method, name) {\n    let edit = false;\n\n    override(object, method, function (original, ...args) {\n        const items = original(...args);\n\n        if (edit) {\n            const modified = new ItemList();\n\n            modified.add('itemlist-order-editor', EditorModal.component({\n                items,\n                name,\n                finishedEdit() {\n                    edit = false;\n                },\n            }));\n\n            return modified;\n        }\n\n        // If empty list, we don't offer any option\n        // TODO: settings if the field has a config but currently nothing in it ?\n        if (!Object.keys(items.items).length) {\n            return items;\n        }\n\n        const config = getStoredConfigForItemList(name);\n\n        if (config) {\n            applyCustomListItemOrdering(items, config);\n        }\n\n        if (editModeEnabled()) {\n            items.add('itemlist-order-control', Button.component({\n                onclick: event => {\n                    event.stopPropagation(); // Prevent dropdowns from closing\n                    edit = true;\n                },\n                icon: 'fas fa-random',\n                className: 'Button',\n                children: 'Edit order',\n                title: name,\n            }), -11000);\n        }\n\n        return items;\n    });\n}\n\nfunction extendListByName(objectName, methodName) {\n    let object = flarum.core.compat[objectName];\n\n    if (objectName.indexOf('components/') === 0) {\n        object = object.prototype;\n    }\n\n    extendList(object, methodName, objectName + '.' + methodName);\n}\n\napp.initializers.add('migratetoflarum-itemlist-order', () => {\n    extend(HeaderSecondary.prototype, 'items', items => {\n        if (!editModeEnabled()) {\n            return;\n        }\n\n        if (app.forum.attribute('allowSignUp')) {\n            items.add('signUp',\n                Button.component({\n                    children: app.translator.trans('core.forum.header.sign_up_link'),\n                    className: 'Button Button--link',\n                    onclick: () => app.modal.show(new SignUpModal()),\n                }), 10\n            );\n        }\n\n        items.add('logIn',\n            Button.component({\n                children: app.translator.trans('core.forum.header.log_in_link'),\n                className: 'Button Button--link',\n                onclick: () => app.modal.show(new LogInModal()),\n            }), 0\n        );\n    });\n\n    // When the page editor is enabled, we need to neutralize the SubtreeRetainer,\n    // otherwise the child modal is difficult or impossible to redraw\n    override(SubtreeRetainer.prototype, 'retain', original => {\n        if (editModeEnabled()) {\n            return false;\n        }\n\n        return original();\n    });\n\n    extendListByName('components/CommentPost', 'headerItems');\n    extendListByName('components/DiscussionComposer', 'headerItems');\n    extendListByName('components/DiscussionHero', 'items');\n    //extendListByName('components/DiscussionListItem', 'infoItems'); // TODO: clicking visits discussion\n    extendListByName('components/DiscussionPage', 'sidebarItems');\n    extendListByName('components/HeaderPrimary', 'items');\n    extendListByName('components/HeaderSecondary', 'items');\n    extendListByName('components/IndexPage', 'sidebarItems');\n    extendListByName('components/IndexPage', 'viewItems');\n    extendListByName('components/IndexPage', 'actionItems');\n    extendListByName('components/LogInModal', 'fields');\n    extendListByName('components/LogInButtons', 'items');\n    extendListByName('components/ReplyComposer', 'headerItems');\n    extendListByName('components/SessionDropdown', 'items');\n    extendListByName('components/SettingsPage', 'settingsItems');\n    extendListByName('components/SignUpModal', 'fields');\n    extendListByName('components/TextEditor', 'controlItems');\n    extendListByName('components/TextEditor', 'toolbarItems');\n    extendListByName('components/UserCard', 'infoItems');\n    extendListByName('components/UserPage', 'navItems');\n    extendListByName('utils/DiscussionControls', 'controls');\n    extendListByName('utils/PostControls', 'controls');\n    extendListByName('utils/UserControls', 'controls');\n    // TODO: itemlist for locales ? needs PR to core\n}, -1000); // Low priority, this extension MUST be the last one to extend any ItemList !\n","export default function (items, config) {\n    let startIndex = 10000; // TODO: don't hard-code\n    config.start.forEach(name => {\n        if (items.has(name)) {\n            items.replace(name, null, startIndex--);\n        }\n    });\n\n    let endIndex = -10000; // TODO: don't hard-code\n    config.end.forEach(name => {\n        if (items.has(name)) {\n            items.replace(name, null, endIndex--);\n        }\n    });\n\n    config.hidden.forEach(name => {\n        if (items.has(name)) {\n            items.remove(name);\n        }\n    });\n}\n","import app from 'flarum/app';\n\nexport default function (name) {\n    if (app.forum.data.attributes.itemorderConfig && app.forum.data.attributes.itemorderConfig.hasOwnProperty(name)) {\n        const existingConfig = app.forum.data.attributes.itemorderConfig[name];\n\n        return {\n            start: existingConfig.start || [],\n            end: existingConfig.end || [],\n            hidden: existingConfig.hidden || [],\n        };\n    }\n\n    return null;\n}\n","// Same modifications and sorting as in the original ItemList::toArray\nexport default function (list) {\n    const items = [];\n\n    for (const i in list.items) {\n        if (list.items.hasOwnProperty(i) /* removed instanceof check because the class is not public */) {\n            list.items[i].content = Object(list.items[i].content);\n\n            list.items[i].content.itemName = i;\n            items.push(list.items[i]);\n            list.items[i].key = items.length;\n            list.items[i].itemName = i; // Added for ease of access\n        }\n    }\n\n    return items.sort((a, b) => {\n        if (a.priority === b.priority) {\n            return a.key - b.key;\n        } else if (a.priority > b.priority) {\n            return -1;\n        }\n        return 1;\n    });\n}\n","module.exports = flarum.core.compat['Component'];","module.exports = flarum.core.compat['app'];","module.exports = flarum.core.compat['components/Alert'];","module.exports = flarum.core.compat['components/Button'];","module.exports = flarum.core.compat['components/HeaderSecondary'];","module.exports = flarum.core.compat['components/LogInModal'];","module.exports = flarum.core.compat['components/SignUpModal'];","module.exports = flarum.core.compat['extend'];","module.exports = flarum.core.compat['helpers/icon'];","module.exports = flarum.core.compat['utils/ItemList'];","module.exports = flarum.core.compat['utils/SubtreeRetainer'];"],"sourceRoot":""}